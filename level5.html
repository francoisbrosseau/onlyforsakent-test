<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ONLYFORSAKEN — Level 5</title>

  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.62);
      --shadow: rgba(0,0,0,0.80);
      --line: rgba(255,255,255,0.22);
      --tilebg: rgba(0,0,0,0.40);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; background:#000; }

    /* FULLSCREEN HERO */
    .hero{
      min-height:100%;
      position:relative;
      background:
        radial-gradient(70% 60% at 50% 35%, rgba(255,190,120,0.06), rgba(0,0,0,0.86)),
        url("assets/level5-bg.jpg") center/cover no-repeat;
      overflow:hidden;
      font-family:"Cormorant Garamond", serif;
      color:var(--text);
      text-align:center;
    }

    /* GRAIN + VIGNETTE */
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(95% 85% at 50% 40%, rgba(0,0,0,0.10), rgba(0,0,0,0.86)),
        repeating-linear-gradient(0deg,
          rgba(255,255,255,0.018),
          rgba(255,255,255,0.018) 1px,
          rgba(0,0,0,0.00) 2px,
          rgba(0,0,0,0.00) 6px
        );
      mix-blend-mode: overlay;
      opacity:0.62;
      pointer-events:none;
    }

    /* subtle candle glow */
    .hero::after{
      content:"";
      position:absolute; inset:-20%;
      background: radial-gradient(closest-side at 50% 35%, rgba(255,190,120,0.13), rgba(0,0,0,0.0));
      filter: blur(18px);
      opacity:0.30;
      animation: flicker 7.2s ease-in-out infinite;
      pointer-events:none;
    }

    @keyframes flicker{
      0%,100% { transform: translate3d(0,0,0) scale(1); opacity:0.26; }
      22%     { transform: translate3d(-1.2%, 0.8%, 0) scale(1.02); opacity:0.34; }
      55%     { transform: translate3d(1.0%, -0.6%, 0) scale(1.015); opacity:0.28; }
      80%     { transform: translate3d(-0.6%, -0.2%, 0) scale(1.01); opacity:0.32; }
    }

    /* CENTERED CONTENT (NO BOX) */
    .wrap{
      position:relative;
      z-index:2;
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:36px 14px;
    }

    .content{
      width:min(920px, 100%);
    }

    h1{
      font-family:"Cinzel Decorative", serif;
      font-weight:700;
      margin:0 0 10px;
      letter-spacing:0.9px;
      font-size:clamp(28px, 3.8vw, 52px);
      text-shadow:0 0 18px rgba(0,0,0,0.85);
    }

    .subtitle{
      margin:0 0 18px;
      color:rgba(255,255,255,0.60);
      font-size:16px;
      letter-spacing:0.35px;
      text-shadow:0 0 14px rgba(0,0,0,0.75);
    }

    .story{
      margin:0 auto 18px;
      max-width: 780px;
      font-size:18px;
      line-height:1.62;
      color:rgba(255,255,255,0.86);
      text-shadow:0 2px 16px rgba(0,0,0,0.70);
    }

    .divider{
      height:1px;
      width:min(560px, 92%);
      margin:20px auto 18px;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,0.26), transparent);
    }

    .riddleTitle{
      font-family:"Cinzel Decorative", serif;
      font-size:18px;
      margin:0 0 10px;
      letter-spacing:0.6px;
      text-shadow:0 0 16px rgba(0,0,0,0.85);
    }

    .riddle{
      margin:0 auto 6px;
      max-width: 780px;
      font-size:18px;
      line-height:1.58;
      color:rgba(255,255,255,0.80);
      text-shadow:0 2px 16px rgba(0,0,0,0.70);
    }

    /* tiles & slots */
    .tiles{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
      margin:18px 0 14px;
    }

    .tile{
      width:66px;
      height:66px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.18);
      background: radial-gradient(120% 120% at 50% 35%, rgba(255,255,255,0.05), var(--tilebg));
      box-shadow:0 18px 44px rgba(0,0,0,0.55);
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:"Cinzel Decorative", serif;
      font-size:22px;
      letter-spacing:1px;
      cursor:grab;
      user-select:none;
      touch-action:none;
      transition: transform 140ms ease, border-color 180ms ease;
      text-shadow:0 0 10px rgba(0,0,0,0.65);
      opacity:0.92;
      position:relative;
    }
    .tile:active{ cursor:grabbing; transform: translateY(1px) scale(0.995); }
    .tile.selected{ border-color: rgba(255,255,255,0.46); }

    /* Haunted fade */
    @keyframes breatheFade{
      0%,100%{ opacity:0.20; filter: blur(0px); }
      40%    { opacity:0.95; filter: blur(0px); }
      60%    { opacity:0.35; filter: blur(0.2px); }
    }

    /* micro drift */
    @keyframes drift{
      0%,100% { transform: translate3d(0,0,0); }
      50%     { transform: translate3d(0.8px,-0.6px,0); }
    }

    .tile.haunted{
      animation:
        breatheFade var(--fadeDur) ease-in-out infinite,
        drift var(--driftDur) ease-in-out infinite;
    }

    .slots{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
      margin:0 0 12px;
    }

    .slot{
      width:66px;
      height:66px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.22);
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:"Cinzel Decorative", serif;
      font-size:22px;
      letter-spacing:1px;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.40);
      text-shadow:0 0 10px rgba(0,0,0,0.65);
    }

    .slot.filled{
      border-style:solid;
      border-color: rgba(255,255,255,0.26);
      background: rgba(0,0,0,0.40);
    }

    .status{
      min-height:24px;
      color:rgba(255,255,255,0.64);
      font-size:16px;
      margin:10px 0 2px;
      text-shadow:0 2px 16px rgba(0,0,0,0.70);
    }

    .unlock{
      display:none;
      margin-top:14px;
    }

    .unlock a{
      display:inline-block;
      padding:10px 16px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.26);
      background: rgba(0,0,0,0.56);
      color: rgba(255,255,255,0.92);
      text-decoration:none;
      font-family:"Cinzel Decorative", serif;
      letter-spacing:0.6px;
      box-shadow:0 18px 48px rgba(0,0,0,0.62);
      transition: transform 160ms ease, background 180ms ease, border-color 180ms ease;
    }
    .unlock a:hover{
      background: rgba(0,0,0,0.74);
      transform: translateY(-1px);
      border-color: rgba(255,255,255,0.40);
    }

    @media (max-width:520px){
      .tile,.slot{ width:58px; height:58px; border-radius:14px; }
      .story,.riddle{ font-size:17px; }
      .subtitle{ font-size:15px; }
    }
  </style>
</head>

<body>
  <div class="hero">
    <div class="wrap">
      <div class="content">

        <h1>The Sigil Chamber</h1>
        <div class="subtitle">The mark is watching back.</div>

        <p class="story">
          (We’ll refine this story next. For now: the chamber, the basin, the shifting mark, and the tiles that won’t sit still.)
        </p>

        <div class="divider"></div>

        <div class="riddleTitle">Riddle</div>
        <p class="riddle">
          I am drawn, not spoken.<br>
          A key that looks like a scar.<br>
          Five strokes bind the gate—<br>
          the rest are counterfeit.
        </p>

        <!-- Tiles are REMIXED so SIGIL is NOT the first 5 -->
        <div class="tiles" id="tiles">
          <!-- decoys first -->
          <div class="tile haunted" draggable="true" data-letter="E">E</div>
          <div class="tile haunted" draggable="true" data-letter="T">T</div>
          <div class="tile haunted" draggable="true" data-letter="O">O</div>
          <div class="tile haunted" draggable="true" data-letter="V">V</div>
          <div class="tile haunted" draggable="true" data-letter="C">C</div>

          <!-- real letters mixed in (not grouped) -->
          <div class="tile haunted" draggable="true" data-letter="I">I</div>
          <div class="tile haunted" draggable="true" data-letter="L">L</div>
          <div class="tile haunted" draggable="true" data-letter="S">S</div>
          <div class="tile haunted" draggable="true" data-letter="G">G</div>
          <div class="tile haunted" draggable="true" data-letter="I">I</div>

          <!-- tricky impostors -->
          <div class="tile haunted" draggable="true" data-letter="|">|</div>
          <div class="tile haunted" draggable="true" data-letter="1">1</div>
        </div>

        <div class="slots" id="slots">
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
        </div>

        <div class="status" id="status">The room watches.</div>

        <div class="unlock" id="unlock">
          <a href="level6.html">Enter the next threshold</a>
        </div>

      </div>
    </div>
  </div>

  <script>
    const ANSWER = "SIGIL";

    const tiles = Array.from(document.querySelectorAll(".tile"));
    const slots = Array.from(document.querySelectorAll(".slot"));
    const statusEl = document.getElementById("status");
    const unlockEl = document.getElementById("unlock");

    let draggedTile = null;
    let selectedTile = null;

    // randomize each tile's fade timing so it looks alive
    tiles.forEach((t, i) => {
      if (t.classList.contains("haunted")) {
        const fade = 3.2 + Math.random() * 2.8;   // 3.2s - 6.0s
        const drift = 4.0 + Math.random() * 3.5;  // 4.0s - 7.5s
        t.style.setProperty("--fadeDur", fade.toFixed(2) + "s");
        t.style.setProperty("--driftDur", drift.toFixed(2) + "s");

        // stagger start so it's not synchronized
        t.style.animationDelay = (Math.random() * 1.8).toFixed(2) + "s";
      }
    });

    function currentAttempt(){
      return slots.map(s => s.textContent.trim()).join("");
    }

    function clearSelection(){
      tiles.forEach(t => t.classList.remove("selected"));
      selectedTile = null;
    }

    function check(){
      const a = currentAttempt();
      if(a.length < ANSWER.length){
        unlockEl.style.display = "none";
        statusEl.textContent = "The room watches.";
        return;
      }
      if(a === ANSWER){
        statusEl.textContent = "The mark completes. The door yields.";
        unlockEl.style.display = "block";
      }else{
        unlockEl.style.display = "none";
        statusEl.textContent = "The mark rejects you.";
      }
    }

    // Desktop drag/drop
    tiles.forEach(t => {
      t.addEventListener("dragstart", () => draggedTile = t);

      // Tap select (mobile helper, no on-screen instruction)
      t.addEventListener("click", () => {
        tiles.forEach(x => x.classList.remove("selected"));
        selectedTile = t;
        t.classList.add("selected");
      });
    });

    slots.forEach(s => {
      s.addEventListener("dragover", e => e.preventDefault());

      s.addEventListener("drop", () => {
        if(!draggedTile) return;
        s.textContent = draggedTile.dataset.letter;
        s.classList.add("filled");
        check();
      });

      // tap place
      s.addEventListener("click", () => {
        if(!selectedTile) return;
        s.textContent = selectedTile.dataset.letter;
        s.classList.add("filled");
        clearSelection();
        check();
      });

      // dbl click clear (desktop)
      s.addEventListener("dblclick", () => {
        s.textContent = "";
        s.classList.remove("filled");
        unlockEl.style.display = "none";
        statusEl.textContent = "The room watches.";
      });
    });
  </script>
</body>
</html>
