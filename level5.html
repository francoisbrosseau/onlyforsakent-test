<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ONLYFORSAKEN — Level 5</title>

  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.58);
      --shadow: rgba(0,0,0,0.76);
      --panel: rgba(6,6,8,0.55);
      --line: rgba(255,255,255,0.16);
      --line2: rgba(255,255,255,0.26);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; background:#000; }

    .hero{
      min-height:100%;
      position:relative;
      background:
        radial-gradient(70% 60% at 50% 35%, rgba(255,190,120,0.06), rgba(0,0,0,0.84)),
        url("assets/level5-bg.jpg") center/cover no-repeat;
      overflow:hidden;
      font-family:"Cormorant Garamond", serif;
      color:var(--text);
    }

    /* grain + vignette */
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(90% 80% at 50% 40%, rgba(0,0,0,0.10), rgba(0,0,0,0.84)),
        repeating-linear-gradient(0deg,
          rgba(255,255,255,0.018),
          rgba(255,255,255,0.018) 1px,
          rgba(0,0,0,0.00) 2px,
          rgba(0,0,0,0.00) 6px
        );
      mix-blend-mode: overlay;
      opacity:0.62;
      pointer-events:none;
    }

    /* subtle candle drift */
    .hero::after{
      content:"";
      position:absolute; inset:-20%;
      background: radial-gradient(closest-side at 50% 35%, rgba(255,190,120,0.12), rgba(0,0,0,0.0));
      filter: blur(18px);
      opacity:0.30;
      animation: flicker 7s ease-in-out infinite;
      pointer-events:none;
    }

    @keyframes flicker{
      0%,100% { transform: translate3d(0,0,0) scale(1); opacity:0.28; }
      22%     { transform: translate3d(-1.3%, 0.9%, 0) scale(1.02); opacity:0.36; }
      55%     { transform: translate3d(1.0%, -0.6%, 0) scale(1.015); opacity:0.30; }
      80%     { transform: translate3d(-0.6%, -0.2%, 0) scale(1.01); opacity:0.34; }
    }

    .wrap{
      position:relative;
      z-index:2;
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px 14px;
      text-align:center;
    }

    .panel{
      width:min(900px, 100%);
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:26px;
      padding:30px 22px 24px;
      box-shadow:0 26px 90px var(--shadow);
      backdrop-filter: blur(6px);
    }

    h1{
      font-family:"Cinzel Decorative", serif;
      font-weight:700;
      margin:0 0 10px;
      letter-spacing:0.9px;
      font-size:clamp(26px, 3.6vw, 46px);
      text-shadow:0 0 18px rgba(0,0,0,0.75);
    }

    .subtitle{
      margin:0 0 18px;
      color:rgba(255,255,255,0.55);
      font-size:16px;
      letter-spacing:0.35px;
    }

    .story{
      margin:0 auto 18px;
      max-width: 760px;
      font-size:18px;
      line-height:1.62;
      color:rgba(255,255,255,0.84);
    }

    .divider{
      height:1px;
      width:min(560px, 92%);
      margin:20px auto 18px;
      background:linear-gradient(90deg, transparent, rgba(255,255,255,0.24), transparent);
    }

    .riddleTitle{
      font-family:"Cinzel Decorative", serif;
      font-size:18px;
      margin:0 0 10px;
      letter-spacing:0.6px;
      color:rgba(255,255,255,0.92);
    }

    .riddle{
      margin:0 auto 6px;
      max-width: 760px;
      font-size:18px;
      line-height:1.58;
      color:rgba(255,255,255,0.78);
    }

    /* puzzle */
    .tiles{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
      margin:18px 0 14px;
    }

    .tile{
      width:66px;
      height:66px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.26);
      background: radial-gradient(120% 120% at 50% 35%, rgba(255,255,255,0.06), rgba(0,0,0,0.64));
      box-shadow:0 18px 44px rgba(0,0,0,0.55);
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:"Cinzel Decorative", serif;
      font-size:22px;
      letter-spacing:1px;
      cursor:grab;
      user-select:none;
      touch-action:none;
      transition: transform 140ms ease, border-color 180ms ease, opacity 180ms ease;
    }

    .tile:active{ cursor:grabbing; transform: translateY(1px) scale(0.995); }

    .tile.selected{
      border-color: rgba(255,255,255,0.52);
      box-shadow:0 0 0 2px rgba(255,255,255,0.10), 0 18px 44px rgba(0,0,0,0.62);
    }

    .slots{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
      margin:0 0 12px;
    }

    .slot{
      width:66px;
      height:66px;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,0.24);
      background: rgba(255,255,255,0.03);
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:"Cinzel Decorative", serif;
      font-size:22px;
      letter-spacing:1px;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.38);
      transition: transform 120ms ease, border-color 180ms ease, background 180ms ease;
    }

    .slot.filled{
      border-style:solid;
      border-color: rgba(255,255,255,0.32);
      background: rgba(0,0,0,0.48);
    }

    .status{
      min-height:24px;
      color:rgba(255,255,255,0.62);
      font-size:16px;
      margin:8px 0 2px;
    }

    .unlock{
      display:none;
      margin-top:12px;
    }

    .unlock a{
      display:inline-block;
      padding:10px 16px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.32);
      background: rgba(0,0,0,0.58);
      color: rgba(255,255,255,0.92);
      text-decoration:none;
      font-family:"Cinzel Decorative", serif;
      letter-spacing:0.6px;
      box-shadow:0 18px 48px rgba(0,0,0,0.62);
      transition: transform 160ms ease, background 180ms ease, border-color 180ms ease;
    }
    .unlock a:hover{
      background: rgba(0,0,0,0.74);
      transform: translateY(-1px);
      border-color: rgba(255,255,255,0.46);
    }

    @media (max-width:520px){
      .panel{ padding:24px 16px 18px; border-radius:22px; }
      .tile,.slot{ width:58px; height:58px; border-radius:14px; }
      .story,.riddle{ font-size:17px; }
      .subtitle{ font-size:15px; }
    }
  </style>
</head>

<body>
  <div class="hero">
    <div class="wrap">
      <div class="panel">

        <h1>The Sigil Chamber</h1>
        <div class="subtitle">Some doors don’t want words. They want proof.</div>

        <!-- STORY -->
        <p class="story">
          The corridor doesn’t end — it opens its mouth.
          Stone curves into a circle, carved with grooves like fingernails dragged through wax.
          In the center sits a basin that should be filled, yet holds only a dry shimmer,
          as if something evaporated here and never forgave the air for it.
          <br><br>
          Around the basin, the floor is etched with half-finished patterns: loops, hooks, sharp turns —
          the kind of lines people draw when they’re trying to remember a dream before it collapses.
          You recognize the feeling in your ribs: the room expects repetition.
          It expects obsession.
          <br><br>
          Then you see the door.
          Not a lock — a wound sealed by a shifting mark.
          It refuses to stay the same shape for more than a heartbeat, like it’s embarrassed to be seen.
          Above the basin, a swarm of tiles drifts into view, letters mixed with impostors,
          as if the chamber itself is testing whether you can tell the true mark from a counterfeit.
          <br><br>
          The whisper returns, quieter now, right behind your ear:
          <em>“Choose the real lines. Complete the mark. Let it recognize you.”</em>
        </p>

        <div class="divider"></div>

        <!-- RIDDLE -->
        <div class="riddleTitle">Riddle</div>
        <p class="riddle">
          I am drawn, not spoken.<br>
          I am a key that looks like a scar.<br>
          I bind what should stay shut,<br>
          and obey what you are.<br><br>
          Five marks only — the rest are lies.
        </p>

        <!-- PUZZLE (NO INSTRUCTIONS TEXT) -->
        <div class="tiles" id="tiles">
          <!-- decoys included; also similar shapes to confuse slightly -->
          <div class="tile" draggable="true" data-letter="S">S</div>
          <div class="tile" draggable="true" data-letter="I">I</div>
          <div class="tile" draggable="true" data-letter="G">G</div>
          <div class="tile" draggable="true" data-letter="I">I</div>
          <div class="tile" draggable="true" data-letter="L">L</div>

          <!-- decoys -->
          <div class="tile" draggable="true" data-letter="O">O</div>
          <div class="tile" draggable="true" data-letter="C">C</div>
          <div class="tile" draggable="true" data-letter="E">E</div>
          <div class="tile" draggable="true" data-letter="T">T</div>
          <div class="tile" draggable="true" data-letter="V">V</div>
          <div class="tile" draggable="true" data-letter="|">|</div>
          <div class="tile" draggable="true" data-letter="1">1</div>
        </div>

        <div class="slots" id="slots">
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
          <div class="slot"></div>
        </div>

        <div class="status" id="status">The room watches.</div>

        <div class="unlock" id="unlock">
          <a href="level6.html">Enter the next threshold</a>
        </div>

      </div>
    </div>
  </div>

  <script>
    const ANSWER = "SIGIL";

    const tiles = Array.from(document.querySelectorAll(".tile"));
    const slots = Array.from(document.querySelectorAll(".slot"));
    const statusEl = document.getElementById("status");
    const unlockEl = document.getElementById("unlock");

    let draggedTile = null;
    let selectedTile = null;

    function attempt(){
      return slots.map(s => s.textContent.trim()).join("");
    }

    function clearSelection(){
      tiles.forEach(t => t.classList.remove("selected"));
      selectedTile = null;
    }

    function check(){
      const a = attempt();
      if(a.length < ANSWER.length){
        unlockEl.style.display = "none";
        statusEl.textContent = "The room watches.";
        return;
      }
      if(a === ANSWER){
        statusEl.textContent = "The mark completes. The door yields.";
        unlockEl.style.display = "block";
      }else{
        unlockEl.style.display = "none";
        statusEl.textContent = "The mark rejects you.";
      }
    }

    // drag (desktop)
    tiles.forEach(t => {
      t.addEventListener("dragstart", () => draggedTile = t);

      // tap-select (mobile + desktop)
      t.addEventListener("click", () => {
        tiles.forEach(x => x.classList.remove("selected"));
        selectedTile = t;
        t.classList.add("selected");
      });
    });

    // slots
    slots.forEach(s => {
      s.addEventListener("dragover", e => e.preventDefault());

      s.addEventListener("drop", () => {
        if(!draggedTile) return;
        s.textContent = draggedTile.dataset.letter;
        s.classList.add("filled");
        check();
      });

      s.addEventListener("click", () => {
        if(!selectedTile) return;
        s.textContent = selectedTile.dataset.letter;
        s.classList.add("filled");
        clearSelection();
        check();
      });

      s.addEventListener("dblclick", () => {
        s.textContent = "";
        s.classList.remove("filled");
        unlockEl.style.display = "none";
        statusEl.textContent = "The room watches.";
      });
    });
  </script>
</body>
</html>
